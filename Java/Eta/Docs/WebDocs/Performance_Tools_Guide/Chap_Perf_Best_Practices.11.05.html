<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>11.2.3 Packing</title>
    <link rel="StyleSheet" href="css/Chap_Perf_Best_Practices.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55718642-4', 'auto');
  ga('send', 'pageview');

</script>
  </head>
  <body onload="WWHUpdate();" onunload="WWHUnload();" onkeydown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onkeypress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onkeyup="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <table width="100%" align="left" role="presentation">
      <tr>
        <td class="WebWorks_Company_Name_Top" width="250">
          <div id="boxC">Transport API Java Edition</div>
        </td>
        <td width="30">
          <div id="boxB"></div>
        </td>
        <td width="*"></td>
        <td class="WebWorks_Company_Logo_Top" width="160">
          <div id="boxA">
            <img align="left" src="banner_logo.gif" alt="Transport API Java Edition" />
          </div>
        </td>
      </tr>
    </table>
    <br clear="all" />
    <hr align="left" />
    <blockquote>
      <div class="H3"><a name="1222863">Packing</a></div>
      <div class="Body"><a name="1226379"><!--o--></a>To efficiently use buffer space, reduce the number of writes to the transport,<sup><a name="wwfootnote_inline_32" href="#32">1</a></sup> and improve throughput, applications can use the <span class="CodeOrCommand">Channel.packBuffer()</span> method to pack multiple messages into a single buffer. Each call to <span class="CodeOrCommand">Channel.packBuffer()</span> adds another message to the existing buffer. Though packing messages can help increase throughput, overall effects will vary depending on the type of transport you use. In general:</div>
      <div class="bullet_ind_outer" style="margin-left: 18pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="bullet_ind_inner" style="width: 18pt; white-space: nowrap">
                <span class="AG_bold">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="bullet_ind_inner"><a name="1226389">Slower transports benefit more than faster transports</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="bullet_ind_outer" style="margin-left: 18pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="bullet_ind_inner" style="width: 18pt; white-space: nowrap">
                <span class="AG_bold">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="bullet_ind_inner"><a name="1226390">More saturated transports benefit more than less-saturated ones.</a></div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Body"><a name="1226391">Because packing adds latency, it is important that you weigh the trade-offs when deciding to employ packing. For example, if 15 messages are packed into a single buffer, the first message will sit in the buffer longer before being written than the last message added to the buffer. An application can reduce this latency by sending the packed buffer before it is full, often through the use of a timing mechanism that indicates a latency threshold has been reached. In general, the more messages packed into a buffer, the higher the latency penalty.</a></div>
      <div class="Body"><span class="ToolOrUtility_Name"><a name="1226401">upajProvPerf</a></span> and <span class="ToolOrUtility_Name">upajNIProvPerf</span> perform the following steps when configured to pack buffers:</div>
      <div class="Step1_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="Step1_inner" style="width: 18pt; white-space: nowrap">
                <span class="Bold">1.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Step1_inner"><a name="1226405">Get a packable buffer of a specified size, using </a><span class="CodeOrCommand">Channel.getBuffer()</span>.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Stepnext_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="Stepnext_inner" style="width: 18pt; white-space: nowrap">
                <span class="Bold">2.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Stepnext_inner"><a name="1226409">Encode messages into the buffer, calling </a><span class="CodeOrCommand">Channel.packBuffer()</span> after each message is encoded.</div>
            </td>
          </tr>
        </table>
      </div>
      <div class="Stepnext_outer" style="margin-left: 0pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="Stepnext_inner" style="width: 18pt; white-space: nowrap">
                <span class="Bold">3.	</span>
              </div>
            </td>
            <td width="100%">
              <div class="Stepnext_inner"><a name="1226413">After the configured number of messages are packed or when the buffer is full, </a><span class="CodeOrCommand">Channel.write()</span> is called to pass the packed buffer to the Transport API.</div>
            </td>
          </tr>
        </table>
      </div>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
      <hr />
      <div style="font-size: smaller; float: left; padding-right: 10px;">
        <a name="32" href="#wwfootnote_inline_32">1</a>
      </div>
      <div class="Footnote"><a name="1226378">Reducing underlying transport header overhead.</a></div>
      <br style="clear: both;" />
    </blockquote>
    <hr align="left" />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <a class="WebWorks_Breadcrumb_Link" href="Chap_Perf_Best_Practices.11.01.html">Chapter 11	Performance Best Practices</a> : <a class="WebWorks_Breadcrumb_Link" href="Chap_Perf_Best_Practices.11.03.html">11.2	Transport Best Practices</a> : 11.2.3	Packing</div>
    <br />
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>